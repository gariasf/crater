import{a9 as F,u as H,m as M,ax as z,M as q,N as O,I as V,a4 as X,r as n,o as p,k as g,i as e,g as t,a as o,R as f,z as T,t as S,h as P,H as G,ay as J,d as Y,e as A,a5 as $,n as K,c as Q,y as W}from"./main.85eae20a.js";import{_ as Z}from"./TaxTypeModal.8af63e3e.js";const ee={__name:"TaxTypeIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(B){const a=B,b=F();H();const{t:r}=M(),h=z(),v=q(),m=O(),E=V();X("utils");async function c(d){await h.fetchTaxType(d),E.openModal({title:r("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:a.loadData&&a.loadData})}function D(d){b.openDialog({title:r("general.are_you_sure"),message:r("settings.tax_types.confirm_delete"),yesLabel:r("general.ok"),noLabel:r("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async u=>{if(u){if((await h.deleteTaxType(d)).data.success)return a.loadData&&a.loadData(),!0;a.loadData&&a.loadData()}})}return(d,u)=>{const i=n("BaseIcon"),w=n("BaseButton"),C=n("BaseDropdownItem"),k=n("BaseDropdown");return p(),g(k,null,{activator:e(()=>[t(v).name==="tax-types.view"?(p(),g(w,{key:0,variant:"primary"},{default:e(()=>[o(i,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(p(),g(i,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:e(()=>[t(m).hasAbilities(t(f).EDIT_TAX_TYPE)?(p(),g(C,{key:0,onClick:u[0]||(u[0]=I=>c(B.row.id))},{default:e(()=>[o(i,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+S(d.$t("general.edit")),1)]),_:1})):P("",!0),t(m).hasAbilities(t(f).DELETE_TAX_TYPE)?(p(),g(C,{key:1,onClick:u[1]||(u[1]=I=>D(B.row.id))},{default:e(()=>[o(i,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+S(d.$t("general.delete")),1)]),_:1})):P("",!0)]),_:1})}}},te={key:0},oe={__name:"TaxTypesSetting",setup(B){const{t:a}=M(),b=X("utils"),r=G(),h=z(),v=V(),m=O(),E=J(),c=Y(null),D=Y(r.selectedCompanySettings.tax_per_item),d=A(()=>[{key:"name",label:a("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"compound_tax",label:a("settings.tax_types.compound_tax"),tdClass:"font-medium text-gray-900"},{key:"percent",label:a("settings.tax_types.percent"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),u=A(()=>r.selectedCompanySettings.sales_tax_us_enabled==="YES"&&E.salesTaxUSEnabled),i=A({get:()=>D.value==="YES",set:async l=>{const _=l?"YES":"NO";let y={settings:{tax_per_item:_}};D.value=_,await r.updateCompanySettings({data:y,message:"general.setting_updated"})}});function w(){return m.hasAbilities([f.DELETE_TAX_TYPE,f.EDIT_TAX_TYPE])}async function C({page:l,filter:_,sort:y}){let N={orderByField:y.fieldName||"created_at",orderBy:y.order||"desc",page:l},x=await h.fetchTaxTypes(N);return{data:x.data.data,pagination:{totalPages:x.data.meta.last_page,currentPage:l,totalCount:x.data.meta.total,limit:5}}}async function k(){c.value&&c.value.refresh()}function I(){v.openModal({title:a("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:c.value&&c.value.refresh})}return(l,_)=>{const y=n("BaseIcon"),N=n("BaseButton"),x=n("BaseBadge"),L=n("BaseTable"),R=n("BaseDivider"),U=n("BaseSwitchSection"),j=n("BaseSettingCard");return p(),g(j,{title:l.$t("settings.tax_types.title"),description:l.$t("settings.tax_types.description")},$({default:e(()=>[o(Z),o(L,{ref_key:"table",ref:c,class:"mt-16",data:C,columns:t(d)},$({"cell-compound_tax":e(({row:s})=>[o(x,{"bg-color":t(b).getBadgeStatusColor(s.data.compound_tax?"YES":"NO").bgColor,color:t(b).getBadgeStatusColor(s.data.compound_tax?"YES":"NO").color},{default:e(()=>[T(S(s.data.compound_tax?"Yes":"No".replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-percent":e(({row:s})=>[T(S(s.data.percent)+" % ",1)]),_:2},[w()?{name:"cell-actions",fn:e(({row:s})=>[o(ee,{row:s.data,table:c.value,"load-data":k},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"]),t(m).currentUser.is_owner?(p(),Q("div",te,[o(R,{class:"mt-8 mb-2"}),o(U,{modelValue:t(i),"onUpdate:modelValue":_[0]||(_[0]=s=>W(i)?i.value=s:null),disabled:t(u),title:l.$t("settings.tax_types.tax_per_item"),description:l.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","disabled","title","description"])])):P("",!0)]),_:2},[t(m).hasAbilities(t(f).CREATE_TAX_TYPE)?{name:"action",fn:e(()=>[o(N,{type:"submit",variant:"primary-outline",onClick:I},{left:e(s=>[o(y,{class:K(s.class),name:"PlusIcon"},null,8,["class"])]),default:e(()=>[T(" "+S(l.$t("settings.tax_types.add_new_tax")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"])}}};export{oe as default};
